<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.web.gec.mapper.AuctionMapperCustom" >
  <resultMap id="findAuctionAndRecordListMap" type="com.web.gec.pojo.Auction" >
    <id column="auctionId" property="auctionid" jdbcType="INTEGER" />
    <result column="auctionName" property="auctionname" jdbcType="VARCHAR" />
    <result column="auctionStartPrice" property="auctionstartprice" jdbcType="DECIMAL" />
    <result column="auctionUpset" property="auctionupset" jdbcType="DECIMAL" />
    <result column="auctionStartTime" property="auctionstarttime" jdbcType="TIMESTAMP" />
    <result column="auctionEndTime" property="auctionendtime" jdbcType="TIMESTAMP" />
    <result column="auctionPic" property="auctionpic" jdbcType="VARCHAR" />
    <result column="auctionPicType" property="auctionpictype" jdbcType="VARCHAR" />
    <result column="auctionDesc" property="auctiondesc" jdbcType="VARCHAR" />
    <collection property="auctionrecordList" ofType="com.web.gec.pojo.Auctionrecord">
        <id column="record_id" property="id" jdbcType="INTEGER" />
        <result column="record_user_id" property="userid" jdbcType="INTEGER" />
        <result column="record_auction_id" property="auctionid" jdbcType="INTEGER" />
        <result column="auctionTime" property="auctiontime" jdbcType="TIMESTAMP" />
        <result column="auctionPrice" property="auctionprice" jdbcType="DECIMAL" />
      <association property="user" javaType="com.web.gec.pojo.Auctionuser">
          <id column="record_user_id" property="userid" jdbcType="INTEGER" />
          <result column="userName" property="username" jdbcType="VARCHAR" />
      </association>
    </collection>
  </resultMap>
  <select id="findAuctionAndRecordList" parameterType="int" resultMap="findAuctionAndRecordListMap">
    select
      auction.*,
      auctionrecord.id record_id,
      auctionrecord.userId record_user_id,
      auctionrecord.auctionId record_auction_id,
      auctionrecord.auctionPrice,
      auctionrecord.auctionTime,
      auctionuser.userName
      FROM
      auction
      LEFT JOIN auctionrecord ON auction.auctionId = auctionrecord.auctionId
      LEFT JOIN auctionuser ON auctionrecord.userId = auctionuser.userId
      WHERE auction.auctionId = #{id} order by auctionRecord.auctionPrice desc ;
  </select>
</mapper>